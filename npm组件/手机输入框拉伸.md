# 手机输入框拉伸


1. 保存当前屏幕的高度height
2. 判断当前使用的机型(iphone需要保留一个高度为输入法切换做预留)
3. 定义一个拉伸方法scrollTop
4. 监听window对象的scroll拉伸和resize形变
5. 当发现存在时需要调用输入框拉伸方法,同时防抖监听
6. 在点击输入框时调用输入框拉伸方法
7. 判断屏幕是否发生了拉伸或形变,是->8 否 ->9
8. 判断当前的拉伸或形变的值是否在一定阈值内 ,是->10 否 ->11
9. 取消当前点击输入框
10. 已成功,调用成功方法
11. 拉伸屏幕,并判断机型 安卓 -> 12 ios ->13
12. 安卓 存在 document.activeElement.scrollIntoViewIfNeeded的调用方法,不存在方法并且存在拉伸的 -> 13
13. 判断当前的拉伸或形变的值是否在一定阈值内 是 ->10 否 -> 14
14. 获取高度和拉伸数据判断状态 
    a. 当前拉伸了一段距离,认为是正常拉伸 
    b. 拉伸的高度小于高度的1/2,认为是正常拉伸 
    c. 拉伸的高度大于等于高度的1/2,认为是不正常拉伸, 对高度进行修正
    d. 拉伸总长度远大于原始高度,认为是不正常拉伸, 对高度进行修正
15. 过一段时间再次获取14中的值对两组值进行比较
    相同的说明没有发生改变 -> 10
    拉伸高度不同的再次修正并重复 15 (只比较两次)
    新的屏幕高不同的修改屏幕的高度 -> 10
    其他情况一样认为成功 -> 10


#### 原理
ios和安卓所使用的方案是不同的, 输入框唤醒机制存在不同

键盘唤醒分为两种
    1. scroll滑动
    2. resize高度变化

ios基本使用scroll滑动
由于第三方键盘是先等系统键盘加载了然后覆盖的，所以高度会有二次变化,但是这个变化不会引发第二次scroll滑动

安卓基本使用的是 resize高度变化

#### 流程图
参见 杂项/流程图/输入框拉伸v2.pos