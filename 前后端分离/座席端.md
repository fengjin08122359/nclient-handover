# 座席端

### 核心
1. keyFrame 发布订阅
通过发布订阅模式连接不同的用户状态
在每个状态中独立处理
keyFrame参见 [https://www.npmjs.com/package/nclient-microfront](https://www.npmjs.com/package/nclient-microfront) frame片段监听

2. 组件化
代码组件化划分,不同的目录中处理不同的事务  
client -> sdk主入口  
client-data -> 数据层  
client-http -> 接口连接整理  
client-message -> websocket消息连接  

3. vuex和keyframe组合
将分离的部分重组拼接
```javascript
state.keyFrame.addHandler('store', 'client-data-skin-logo', (data) => {
  dispatch('skin/setLogo', data, {root: true});
})
```
参见 杂项/sdk与vuex.md

4. 打包更新
参见 杂项/打包

#### 目录: 
- src -> 开发文件夹  
  - components -> 通用插件  
    - Alert -> 提示框  
    - BlockVisitor -> 封锁访客  
    - Chat -> 对话主插件  
      - Aside -> 边栏  
        - Category -> 对话分类  
        - CommonStoreAside -> 常用预存  
        - History -> 历史记录  
        - Information -> 访客信息  
        - PluginCenter -> 插件中心  
        - Recommend -> 智能推荐  
      - AFontTool -> 字体(未使用)  
      - ChatAside -> 边栏主体  
      - ChatList -> 对话框  
      - SingleChat -> 单一对话  
      - ToolList -> 工具栏  
      - UserList -> 访客列表  
    - ContextMenu -> 右键菜单  
    - Cover -> 加载遮罩  
    - ImgPreview -> 图片预览  
    - validator -> 验证  
    - VisitorMonitor -> 访客监控插件  
    - BasicConfig -> 坐席端设置  
    - ForeKnow -> 消息预知  
    - ImgPresend -> 图片,文件预发送  
    - Mcontent -> 输入框  
    - Status -> 状态栏  
    - Upload -> 文件发送  
    - VueAudio -> 音频  
  - css -> 样式文件  
  - images -> 图片  
  - page ->  路由页面  
    - main -> 对话页面  
      - Chat -> 对话  
      - ClientMonitor -> 坐席监控  
      - CommonStore -> 常用预存  
      - LeaveMessage -> 访客留言  
      - Notice -> 系统通知  
      - ServiceRecord -> 对话管理  
      - VisitorMonitor -> 访客监控  
    - Error -> 错误页面  
    - Loading -> 加载中(未使用)  
    - login -> 登录  
    - Main -> 对话页面主体  
  - router -> 路由  
  - sdk -> sdk接口文件  
    - changeTitle -> 切换标题  
    - client -> sdk主入口  
    - client-data -> 数据层  
    - client-http -> 接口连接整理  
    - client-message -> websocket消息连接  
    - client-status -> 状态  
    - faceIco -> 表情  
    - lang -> 多语言  
    - mobileInput -> 手机输入框适配  
    - screenCapture -> 截屏  
  - store -> vuex的实例  
  - util -> 工具文件夹  
- public  
  - static -> 静态文件  
  - images -> 对话静态文件  
  - img -> 图标文件  
  - tools -> websoket使用flash方式连接的文件  
- vue.config.js -> 配置项  


#### sdk改版后的目录: 
- src 
  - sdk
    - control             控制层
      - commonHandle.js   处理通用层方法
      - dataHandle.js     处理数据层方法
      - keyHandle.js      处理外部调用
      - index.js          sdk初始化
    - http                http接口    
      - filter.js         http数据处理  
      - index.js          接口列表
    - language            多语言数据
      - en.js             英语
      - zh_TW.js          繁体中文
      - zh-cn.js          简体中文
    - state               状态层
      - [组件]              (与改版前client-data中的相同)
        - data.js         数据层
        - index.js        数据处理
      - ...
    - websocket           websocket
      - index.js          初始化,接收发送消息
      - UccMessage.js     一般消息类型
      - UccReceipts.js    回执消息类型
    - index               sdk入口
  - sdk-extend            sdk外部扩展